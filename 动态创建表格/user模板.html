<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="css/user.css">
</head>

<body>
    <h1>æ–°å¢å­¦å‘˜</h1>
    <div class="info">
        å§“åï¼š<input type="text" class="uname"> å¹´é¾„ï¼š
        <input type="text" class="age"> æ€§åˆ«: <select name="gender" id="" class="gender">
      <option value="ç”·">ç”·</option>
      <option value="å¥³">å¥³</option>
    </select> è–ªèµ„ï¼š
        <input type="text" class="salary"> å°±ä¸šåŸå¸‚ï¼š
        <select name="city" id="" class="city">
      <option value="åŒ—äº¬">åŒ—äº¬</option>
      <option value="ä¸Šæµ·">ä¸Šæµ·</option>
      <option value="å¹¿å·">å¹¿å·</option>
      <option value="æ·±åœ³">æ·±åœ³</option>
      <option value="æ›¹å¿">æ›¹å¿</option>

    </select>
        <button class="add">å½•å…¥</button>
    </div>

    <h1>å°±ä¸šæ¦œ</h1>
    <table>
        <thead>
            <tr>
                <th>å­¦å·</th>
                <th>å§“å</th>
                <th>å¹´é¾„</th>
                <th>æ€§åˆ«</th>
                <th>è–ªèµ„</th>
                <th>å°±ä¸šåŸå¸‚</th>
                <th>æ“ä½œ</th>
            </tr>
        </thead>
        <tbody>
            <!-- <tr>
        <td>1001</td>
        <td>æ¬§é˜³éœ¸å¤©</td>
        <td>19</td>
        <td>ç”·</td>

        <td>15000</td>
        <td>ä¸Šæµ·</td>
        <td>
          <a href="javascript:">åˆ é™¤</a>
        </td>
      </tr> -->
        </tbody>
    </table>
    <script>
        // ğŸ˜Š  è¯»å–æœ¬åœ°å­˜å‚¨çš„æ•°æ®  å› ä¸º å­˜ï¼Œå–ï¼Œåˆ ï¼Œæ¸²æŸ“ éƒ½éœ€è¦æœ¬åœ°å­˜å‚¨çš„æ•°æ®ï¼Œå¯ä»¥å°è£…æˆä¸€ä¸ªå‡½æ•°
        function getLocalData() {
            let data = localStorage.getItem('data')
                //å¦‚æœæœ¬åœ°å­˜å‚¨æœ‰æ•°æ®
            if (data) {
                return JSON.parse(data) //JSON.parse()è¿”å›çš„æ˜¯å¯¹è±¡{}
            } else {
                //å¦‚æœæœ¬åœ°å­˜å‚¨æ²¡æœ‰æ•°æ®

                //  å‡†å¤‡å¥½æ•°æ®åç«¯çš„æ•°æ®
                let arr = [{
                        stuId: 1001,
                        uname: 'æ¬§é˜³éœ¸å¤©',
                        age: 19,
                        gender: 'ç”·',
                        salary: '20000',
                        city: 'ä¸Šæµ·'
                    }, {
                        stuId: 1002,
                        uname: 'ä»¤ç‹éœ¸å¤©',
                        age: 29,
                        gender: 'ç”·',
                        salary: '30000',
                        city: 'åŒ—äº¬'
                    }, {
                        stuId: 1003,
                        uname: 'è¯¸è‘›éœ¸å¤©',
                        age: 39,
                        gender: 'ç”·',
                        salary: '2000',
                        city: 'åŒ—äº¬'
                    }, ]
                    //å†™å…¥åˆ°æœ¬åœ°å­˜å‚¨é‡Œè¾¹ ä¸èƒ½ç›´æ¥å†™arr å› ä¸ºè¿˜è¦è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ ¼å¼ JSON.stringfy() æ„æ€å°±æ˜¯æŠŠarr ç»™data ç¬¬äºŒæ¬¡å°±å¯ä»¥æ‰§è¡Œif(data)è¿™è¡Œä»£ç äº†
                localStorage.setItem('data', JSON.stringify(arr))
            }
        }






        //  å‡†å¤‡å¥½æ•°æ®åç«¯çš„æ•°æ®
        let arr = [{
            stuId: 1001,
            uname: 'æ¬§é˜³éœ¸å¤©',
            age: 19,
            gender: 'ç”·',
            salary: '20000',
            city: 'ä¸Šæµ·'
        }, {
            stuId: 1002,
            uname: 'ä»¤ç‹éœ¸å¤©',
            age: 29,
            gender: 'ç”·',
            salary: '30000',
            city: 'åŒ—äº¬'
        }, {
            stuId: 1003,
            uname: 'è¯¸è‘›éœ¸å¤©',
            age: 39,
            gender: 'ç”·',
            salary: '2000',
            city: 'åŒ—äº¬'
        }, ]

        // è·å–çˆ¶å…ƒç´  tbody
        let tbody = document.querySelector('tbody')
            // æ·»åŠ æ•°æ®æŒ‰é’® 
            // è·å–å½•å…¥æŒ‰é’®
        let add = document.querySelector('.add')
            // è·å–å„ä¸ªè¡¨å•çš„å…ƒç´ 
        let uname = document.querySelector('.uname')
        let age = document.querySelector('.age')
        let gender = document.querySelector('.gender')
        let salary = document.querySelector('.salary')
        let city = document.querySelector('.city')
            // æ¸²æŸ“å‡½æ•°  æŠŠæ•°ç»„é‡Œé¢çš„æ•°æ®æ¸²æŸ“åˆ°é¡µé¢ä¸­
        function render() {
            // ğŸ¤©æ¸²æŸ“æ¨¡å— å…ˆè¯»å–æœ¬åœ°å­˜å‚¨ï¼Œç„¶åæ¸²æŸ“ è¯»å–çš„å‡½æ•°å·²ç»å°è£…å¥½
            let arr = getLocalData()



            // å…ˆå¹²æ‰ä»¥å‰çš„æ•°æ®  è®©tbody é‡Œé¢åŸæ¥çš„tr éƒ½æ²¡æœ‰
            tbody.innerHTML = ''
                // åœ¨æ¸²æŸ“æ–°çš„æ•°æ®
                // æ ¹æ®æ•°æ®çš„æ¡æ•°æ¥æ¸²æŸ“å¢åŠ  tr  
            for (let i = 0; i < arr.length; i++) {
                // 1.åˆ›å»ºtr  
                let tr = document.createElement('tr')
                    // 2.tr é‡Œé¢æ”¾å†…å®¹
                tr.innerHTML = `
        <td>${arr[i].stuId}</td>
        <td>${arr[i].uname}</td>
        <td>${arr[i].age}</td>
        <td>${arr[i].gender}</td>
        <td>${arr[i].salary}</td>
        <td>${arr[i].city}</td>
        <td>
          <a href="javascript:" data-id="${i}">åˆ é™¤</a>
        </td>
        `
                    // 3.æŠŠtrè¿½åŠ ç»™ tobdy  çˆ¶å…ƒç´ .appendChild(å­å…ƒç´ )
                tbody.appendChild(tr)


            }
        }
        // é¡µé¢åŠ è½½å°±è°ƒç”¨å‡½æ•°
        render()

        add.addEventListener('click', function() {
            // ğŸ¤©å…ˆçœ‹çœ‹æœ‰å¤šå°‘çš„å®¶åº•å„¿å†åŠ   ğŸ¤©åŠ å®Œä¹‹å ğŸ¤©å†å­˜èµ·æ¥ ğŸ¤©å†æ¸²æŸ“
            let arr = getLocalData()

            // alert(11)
            // è·å¾—è¡¨å•é‡Œé¢çš„å€¼   ä¹‹åè¿½åŠ ç»™ æ•°ç»„ arr  ç”¨ pushæ–¹æ³•
            arr.push({
                    // å¾—åˆ°æ•°ç»„æœ€åä¸€æ¡æ•°æ®çš„å­¦å· 1003    + 1
                    stuId: arr[arr.length - 1].stuId + 1,
                    uname: uname.value,
                    age: age.value,
                    gender: gender.value,
                    salary: salary.value,
                    city: city.value
                })
                // console.log(arr)

            //  ğŸ¤©å†å­˜èµ·æ¥
            localStorage.setItem('data', JSON.stringify(arr))


            // é‡æ–°æ¸²æŸ“æˆ‘ä»¬çš„å‡½æ•°
            render()
                // å¤åŸæ‰€æœ‰çš„è¡¨å•æ•°æ®
            uname.value = age.value = salary.value = ''
            gender.value = 'ç”·'
            city.value = 'åŒ—äº¬'
        })


        // åˆ é™¤æ“ä½œï¼Œ åˆ é™¤çš„ä¹Ÿæ˜¯æ•°ç»„é‡Œé¢çš„æ•°æ® ï¼Œ ä½†æ˜¯æˆ‘ä»¬ç”¨äº‹ä»¶å§”æ‰˜
        tbody.addEventListener('click', function(e) {
            // ğŸ¤©å…ˆçœ‹çœ‹æœ‰å¤šå°‘çš„å®¶åº•å„¿å†åˆ   ğŸ¤©åˆ å®Œä¹‹å ğŸ¤©å†å­˜èµ·æ¥ ğŸ¤©å†æ¸²æŸ“
            let arr = getLocalData()


            // alert(11)
            // æˆ‘ä»¬åªèƒ½ç‚¹å‡»äº†é“¾æ¥ a ï¼Œæ‰ä¼šæ‰§è¡Œåˆ é™¤æ“ä½œ
            // é‚£æˆ‘ä»¬æ€ä¹ˆçŸ¥é“ä½ ç‚¹å‡»äº†aå‘¢ï¼Ÿ
            // ä¿ºä»¬åªèƒ½ç‚¹å‡»äº†é“¾æ¥æ‰èƒ½åšåˆ é™¤æ“ä½œ
            // console.dir(e.target.tagName)
            if (e.target.tagName === 'A') {
                // alert('ä½ ç‚¹å‡»äº†é“¾æ¥')
                // åˆ é™¤æ“ä½œ  åˆ é™¤ æ•°ç»„é‡Œé¢çš„æ•°æ®  arr.splice(ä»å“ªé‡Œå¼€å§‹åˆ ï¼Œ1)
                // æˆ‘è¦å¾—åˆ°açš„id éœ€è¦
                // console.log(e.target.id)
                //ç¬¬ä¸€æ¡æ•°æ®ä¸å…è®¸åˆ é™¤
                if (e.target.dataset.id === 0) {
                    alert('ä¸èƒ½åˆ é™¤ç¬¬ä¸€æ¡æ•°æ®')
                    return
                }

                //è‡ªå®šä¹‰å±æ€§ dataset.id  datasetæ˜¯ä¸€ä¸ªé›†åˆ  
                arr.splice(e.target.dataset.id, 1)

                //  ğŸ¤©å†å­˜èµ·æ¥
                localStorage.setItem('data', JSON.stringify(arr))

                // é‡æ–°æ¸²æŸ“æˆ‘ä»¬çš„å‡½æ•°
                render()
            }
        })
    </script>
</body>

</html>